<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StockTrack Pro - AI-Powered Investment Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/moment"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-moment"></script>
    <style>
        :root {
            --bg-dark: #0f172a;
            --card-dark: #1e293b;
            --text-dark: #e2e8f0;
            --primary-dark: #1d4ed8;
            --secondary-dark: #7c3aed;
            --accent-dark: #10b981;
            --danger-dark: #ef4444;
            --warning-dark: #f59e0b;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background-color: #f8fafc;
            color: #1e293b;
            line-height: 1.6;
        }
        
        .dark-mode {
            background-color: var(--bg-dark);
            color: var(--text-dark);
        }
        
        .dark-mode .card {
            background-color: var(--card-dark);
            border-color: #334155;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.25);
        }
        
        .dark-mode .card-header {
            background-color: rgba(30, 41, 59, 0.8);
            border-bottom-color: #334155;
        }
        
        .dark-mode .table {
            color: var(--text-dark);
            --bs-table-bg: transparent;
            --bs-table-striped-bg: rgba(30, 41, 59, 0.5);
            --bs-table-hover-bg: rgba(30, 41, 59, 0.7);
        }
        
        .dark-mode .form-control, 
        .dark-mode .form-select {
            background-color: #1e293b;
            color: var(--text-dark);
            border-color: #334155;
        }
        
        .dark-mode .form-control:focus, 
        .dark-mode .form-select:focus {
            background-color: #1e293b;
            color: var(--text-dark);
            border-color: var(--primary-dark);
            box-shadow: 0 0 0 0.25rem rgba(29, 78, 216, 0.25);
        }
        
        .card {
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            margin-bottom: 24px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1);
        }
        
        .dark-mode .card:hover {
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.3);
        }
        
        .card-header {
            background-color: #f1f5f9;
            color: #1e293b;
            border-bottom: 1px solid #e2e8f0;
            padding: 16px 20px;
            font-weight: 600;
        }
        
        .dark-mode .card-header {
            background-color: rgba(30, 41, 59, 0.8);
            color: var(--text-dark);
            border-bottom-color: #334155;
        }
        
        .positive {
            color: #10b981;
        }
        
        .negative {
            color: #ef4444;
        }
        
        .neutral {
            color: #94a3b8;
        }
        
        .chart-container {
            height: 300px;
            position: relative;
        }
        
        .footer {
            background-color: #1e293b;
            color: #e2e8f0;
            padding: 40px 0;
            margin-top: 60px;
        }
        
        .dark-mode .footer {
            background-color: #0f172a;
        }
        
        .formula-box {
            background-color: #f1f5f9;
            border-left: 4px solid var(--primary-dark);
            padding: 16px;
            margin-bottom: 16px;
            border-radius: 4px;
        }
        
        .dark-mode .formula-box {
            background-color: #1e293b;
            border-left-color: var(--accent-dark);
        }
        
        .pattern-indicator {
            width: 16px;
            height: 16px;
            display: inline-block;
            border-radius: 50%;
            margin-right: 8px;
            vertical-align: middle;
        }
        
        .search-container {
            position: relative;
        }
        
        .search-results {
            position: absolute;
            width: 100%;
            z-index: 1000;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 0 0 8px 8px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .dark-mode .search-results {
            background: var(--card-dark);
            border-color: #334155;
        }
        
        .search-item {
            padding: 12px 16px;
            cursor: pointer;
            border-bottom: 1px solid #e2e8f0;
            transition: background-color 0.2s ease;
        }
        
        .dark-mode .search-item {
            border-bottom-color: #334155;
        }
        
        .search-item:hover {
            background-color: #f8fafc;
        }
        
        .dark-mode .search-item:hover {
            background-color: #334155;
        }
        
        .ai-suggestion {
            border-left: 3px solid var(--accent-dark);
            padding-left: 12px;
            margin-bottom: 16px;
            background-color: rgba(16, 185, 129, 0.05);
        }
        
        .dark-mode .ai-suggestion {
            background-color: rgba(16, 185, 129, 0.1);
        }
        
        .theme-toggle {
            cursor: pointer;
            font-size: 1.25rem;
            transition: transform 0.3s ease;
        }
        
        .theme-toggle:hover {
            transform: scale(1.1);
        }
        
        #stockPerformanceChart, #portfolioAllocationChart, #riskAnalysisChart {
            width: 100%;
            height: 350px;
        }
        
        .news-card {
            height: 100%;
            transition: all 0.3s ease;
        }
        
        .news-card:hover {
            transform: translateY(-3px);
        }
        
        .news-img {
            height: 180px;
            object-fit: cover;
            border-radius: 8px 8px 0 0;
        }
        
        .stock-card {
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
            border: 1px solid #e2e8f0;
        }
        
        .dark-mode .stock-card {
            background-color: var(--card-dark);
            border-color: #334155;
        }
        
        .stock-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .stock-price {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .stock-change {
            font-size: 0.875rem;
            font-weight: 500;
        }
        
        .watchlist-item {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            background-color: white;
            transition: all 0.2s ease;
        }
        
        .dark-mode .watchlist-item {
            background-color: #1e293b;
        }
        
        .watchlist-item:hover {
            background-color: #f8fafc;
            transform: translateX(4px);
        }
        
        .dark-mode .watchlist-item:hover {
            background-color: #334155;
        }
        
        .sector-tag {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 6px;
            margin-bottom: 6px;
        }
        
        .progress-thin {
            height: 6px;
        }
        
        .risk-meter {
            height: 12px;
            border-radius: 6px;
            background: linear-gradient(90deg, #10b981 0%, #f59e0b 50%, #ef4444 100%);
        }
        
        .risk-indicator {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        
        .low-risk {
            background-color: #10b981;
        }
        
        .medium-risk {
            background-color: #f59e0b;
        }
        
        .high-risk {
            background-color: #ef4444;
        }
        
        .notification-badge {
            position: absolute;
            top: -5px;
            right: -5px;
            font-size: 0.6rem;
            padding: 2px 5px;
        }
        
        .blink {
            animation: blink-animation 1.5s infinite;
        }
        
        @keyframes blink-animation {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .market-status {
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
        }
        
        .market-open {
            background-color: rgba(16, 185, 129, 0.2);
            color: #10b981;
        }
        
        .market-closed {
            background-color: rgba(239, 68, 68, 0.2);
            color: #ef4444;
        }
        
        .market-pre {
            background-color: rgba(245, 158, 11, 0.2);
            color: #f59e0b;
        }
        
        .market-post {
            background-color: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }
        
        .glow {
            animation: glow 2s infinite alternate;
        }
        
        @keyframes glow {
            from {
                box-shadow: 0 0 5px rgba(16, 185, 129, 0.5);
            }
            to {
                box-shadow: 0 0 15px rgba(16, 185, 129, 0.8);
            }
        }
        
        .tradingview-widget-container {
            height: 400px;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .skeleton {
            background-color: #e2e8f0;
            border-radius: 4px;
            animation: pulse 1.5s infinite ease-in-out;
        }
        
        .dark-mode .skeleton {
            background-color: #334155;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .card-header h5 {
                font-size: 1rem;
            }
            
            #stockPerformanceChart, #portfolioAllocationChart, #riskAnalysisChart {
                height: 250px;
            }
            
            .stock-price {
                font-size: 1.25rem;
            }
        }
    </style>
</head>
<body class="">
    <!-- Market Status Bar -->
    <div class="bg-dark text-white py-2">
        <div class="container">
            <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <span class="me-3">Market Status: <span id="marketStatus" class="market-status market-open">OPEN</span></span>
                    <span class="me-3">NIFTY 50: <span class="positive">18,742.15 <i class="bi bi-arrow-up"></i> +0.85%</span></span>
                    <span class="me-3">SENSEX: <span class="positive">63,142.96 <i class="bi bi-arrow-up"></i> +0.72%</span></span>
                    <span>USD/INR: <span class="negative">82.94 <i class="bi bi-arrow-down"></i> -0.12%</span></span>
                </div>
                <div id="currentDateTime" class="text-muted">June 3, 2023 10:15 AM IST</div>
            </div>
        </div>
    </div>

    <!-- Main Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <i class="bi bi-graph-up-arrow me-2"></i>
                <span class="fw-bold">StockTrack Pro</span>
                <span class="badge bg-warning text-dark ms-2">AI</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#"><i class="bi bi-speedometer2 me-1"></i> Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="bi bi-plus-circle me-1"></i> Portfolio</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="bi bi-bar-chart me-1"></i> Analysis</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="bi bi-lightning-charge me-1"></i> Screener</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="bi bi-newspaper me-1"></i> News</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="alertsDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-bell"></i>
                            <span class="notification-badge bg-danger rounded-pill blink">3</span>
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="alertsDropdown">
                            <li><h6 class="dropdown-header">New Alerts</h6></li>
                            <li><a class="dropdown-item" href="#">RELIANCE crossed ₹2,450 <span class="text-muted">10 min ago</span></a></li>
                            <li><a class="dropdown-item" href="#">TCS support at ₹3,150 <span class="text-muted">25 min ago</span></a></li>
                            <li><a class="dropdown-item" href="#">New AI recommendation <span class="text-muted">1 hr ago</span></a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><a class="dropdown-item text-primary" href="#">View all alerts</a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <span class="nav-link theme-toggle" id="themeToggle">
                            <i class="bi bi-moon"></i>
                        </span>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#"><i class="bi bi-person-circle"></i></a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container mt-4">
        <!-- Quick Stats Row -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="stock-card positive">
                    <div class="d-flex justify-content-between">
                        <div>
                            <div class="text-muted small">Portfolio Value</div>
                            <div class="stock-price">₹1,24,567</div>
                            <div class="stock-change"><i class="bi bi-arrow-up"></i> +2.34% today</div>
                        </div>
                        <i class="bi bi-briefcase text-muted" style="font-size: 2rem;"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stock-card negative">
                    <div class="d-flex justify-content-between">
                        <div>
                            <div class="text-muted small">Daily Change</div>
                            <div class="stock-price">-₹2,890</div>
                            <div class="stock-change"><i class="bi bi-arrow-down"></i> -1.87% today</div>
                        </div>
                        <i class="bi bi-graph-down text-muted" style="font-size: 2rem;"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stock-card positive">
                    <div class="d-flex justify-content-between">
                        <div>
                            <div class="text-muted small">YTD Return</div>
                            <div class="stock-price">+12.45%</div>
                            <div class="stock-change"><i class="bi bi-arrow-up"></i> +₹13,456</div>
                        </div>
                        <i class="bi bi-calendar-check text-muted" style="font-size: 2rem;"></i>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="stock-card">
                    <div class="d-flex justify-content-between">
                        <div>
                            <div class="text-muted small">Risk Level</div>
                            <div class="d-flex align-items-center mb-1">
                                <div class="risk-indicator medium-risk"></div>
                                <span>Moderate</span>
                            </div>
                            <div class="progress progress-thin">
                                <div class="progress-bar bg-warning" role="progressbar" style="width: 65%"></div>
                            </div>
                        </div>
                        <i class="bi bi-shield-exclamation text-muted" style="font-size: 2rem;"></i>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Search and Watchlist Row -->
        <div class="row mb-4">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="bi bi-search me-2"></i> Advanced Stock Search</h5>
                        <div class="d-flex">
                            <button class="btn btn-sm btn-outline-primary me-2">
                                <i class="bi bi-funnel"></i> Filters
                            </button>
                            <button class="btn btn-sm btn-outline-success">
                                <i class="bi bi-lightning"></i> AI Scan
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="search-container">
                            <div class="input-group mb-3">
                                <span class="input-group-text"><i class="bi bi-search"></i></span>
                                <input type="text" class="form-control form-control-lg" id="stockSearch" placeholder="Search stocks, ETFs, or mutual funds...">
                                <button class="btn btn-primary" type="button">Search</button>
                            </div>
                            <div class="search-results" id="searchResults"></div>
                        </div>
                        
                        <div class="d-flex flex-wrap mt-2">
                            <span class="sector-tag bg-primary text-white">Technology</span>
                            <span class="sector-tag bg-success text-white">Banking</span>
                            <span class="sector-tag bg-info text-white">Automobile</span>
                            <span class="sector-tag bg-warning text-dark">Energy</span>
                            <span class="sector-tag bg-danger text-white">Pharma</span>
                            <span class="sector-tag bg-secondary text-white">FMCG</span>
                            <span class="sector-tag bg-dark text-white">Infrastructure</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="bi bi-star me-2"></i> Watchlist</h5>
                        <button class="btn btn-sm btn-outline-primary" id="editWatchlistBtn">
                            <i class="bi bi-pencil"></i> Edit
                        </button>
                    </div>
                    <div class="card-body p-0">
                        <div class="list-group list-group-flush">
                            <div class="watchlist-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong>RELIANCE</strong>
                                        <div class="text-muted small">Reliance Industries</div>
                                    </div>
                                    <div class="text-end">
                                        <div class="positive">₹2,450.75 <i class="bi bi-arrow-up"></i></div>
                                        <div class="positive small">+1.45%</div>
                                    </div>
                                </div>
                            </div>
                            <div class="watchlist-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong>TCS</strong>
                                        <div class="text-muted small">Tata Consultancy</div>
                                    </div>
                                    <div class="text-end">
                                        <div class="negative">₹3,150.20 <i class="bi bi-arrow-down"></i></div>
                                        <div class="negative small">-0.85%</div>
                                    </div>
                                </div>
                            </div>
                            <div class="watchlist-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong>HDFCBANK</strong>
                                        <div class="text-muted small">HDFC Bank</div>
                                    </div>
                                    <div class="text-end">
                                        <div class="positive">₹1,620.50 <i class="bi bi-arrow-up"></i></div>
                                        <div class="positive small">+0.75%</div>
                                    </div>
                                </div>
                            </div>
                            <div class="watchlist-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong>TATAMOTORS</strong>
                                        <div class="text-muted small">Tata Motors</div>
                                    </div>
                                    <div class="text-end">
                                        <div class="positive">₹620.30 <i class="bi bi-arrow-up"></i></div>
                                        <div class="positive small">+2.15%</div>
                                    </div>
                                </div>
                            </div>
                            <div class="watchlist-item">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div>
                                        <strong>INFY</strong>
                                        <div class="text-muted small">Infosys</div>
                                    </div>
                                    <div class="text-end">
                                        <div class="negative">₹1,280.90 <i class="bi bi-arrow-down"></i></div>
                                        <div class="negative small">-0.45%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main Dashboard Row -->
        <div class="row">
            <div class="col-md-8">
                <!-- Portfolio and Charts -->
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5><i class="bi bi-briefcase me-2"></i> My Investment Portfolio</h5>
                        <div>
                            <button class="btn btn-sm btn-outline-primary me-2" id="addStockBtn">
                                <i class="bi bi-plus"></i> Add
                            </button>
                            <button class="btn btn-sm btn-outline-success">
                                <i class="bi bi-upload"></i> Import
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Stock</th>
                                        <th>Quantity</th>
                                        <th>Avg Cost</th>
                                        <th>Invested</th>
                                        <th>Current</th>
                                        <th>P&L</th>
                                        <th>Allocation</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="portfolioTable">
                                    <!-- Portfolio items will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Chart Row -->
                <div class="row mt-4">
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-graph-up me-2"></i> Portfolio Performance</h5>
                            </div>
                            <div class="card-body">
                                <div id="stockPerformanceChart"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header">
                                <h5><i class="bi bi-pie-chart me-2"></i> Asset Allocation</h5>
                            </div>
                            <div class="card-body">
                                <div id="portfolioAllocationChart"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- TradingView Widget -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h5><i class="bi bi-graph-up-arrow me-2"></i> Live Market Chart</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="tradingview-widget-container">
                            <div class="tradingview-widget-container__widget"></div>
                            <div class="tradingview-widget-copyright">
                                <a href="https://www.tradingview.com/" rel="noopener nofollow" target="_blank">
                                    <span class="blue-text">Track all markets on TradingView</span>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Advanced Calculator -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h5><i class="bi bi-calculator me-2"></i> AI Investment Calculator</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Initial Investment (₹)</label>
                                    <input type="number" class="form-control" id="initialInvestment" value="100000">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Monthly Contribution (₹)</label>
                                    <input type="number" class="form-control" id="monthlyContribution" value="15000">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Expected Annual Return (%)</label>
                                    <div class="input-group">
                                        <input type="number" class="form-control" id="interestRate" value="12">
                                        <button class="btn btn-outline-secondary" type="button" data-bs-toggle="tooltip" title="AI Suggested Rate">
                                            <i class="bi bi-magic"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="mb-3">
                                    <label class="form-label">Investment Period (Years)</label>
                                    <input type="number" class="form-control" id="investmentPeriod" value="10">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Inflation Rate (%)</label>
                                    <input type="number" class="form-control" id="inflationRate" value="6">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Tax Rate (%)</label>
                                    <input type="number" class="form-control" id="taxRate" value="10">
                                </div>
                            </div>
                        </div>
                        <button class="btn btn-primary me-2" onclick="calculateInvestment()">
                            <i class="bi bi-calculator"></i> Calculate
                        </button>
                        <button class="btn btn-outline-primary" onclick="runMonteCarloSimulation()">
                            <i class="bi bi-diagram-3"></i> Run Simulation
                        </button>
                        
                        <div class="formula-box mt-3">
                            <h6><i class="bi bi-lightbulb"></i> Future Value Formula (Automatically Calculated):</h6>
                            <p>A = P(1 + r/n)<sup>nt</sup> + PMT × [(1 + r/n)<sup>nt</sup> - 1] / (r/n)</p>
                            <p>Where:<br>
                            A = Future Value<br>
                            P = Initial Investment<br>
                            PMT = Monthly Contribution<br>
                            r = Annual Interest Rate<br>
                            n = Compounding periods per year<br>
                            t = Investment period in years</p>
                        </div>
                        
                        <div id="calculationResult" class="mt-3" style="display: none;">
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="card bg-light mb-3">
                                        <div class="card-body">
                                            <h5>Nominal Value:</h5>
                                            <p>Future Value: <span id="futureValue" class="fw-bold fs-4"></span></p>
                                            <p>Total Contributions: <span id="totalContributions"></span></p>
                                            <p>Interest Earned: <span id="interestEarned"></span></p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <div class="card bg-light mb-3">
                                        <div class="card-body">
                                            <h5>Inflation Adjusted:</h5>
                                            <p>Real Future Value: <span id="realFutureValue" class="fw-bold fs-4"></span></p>
                                            <p>After Tax Value: <span id="afterTaxValue"></span></p>
                                            <p>Purchasing Power: <span id="purchasingPower"></span></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div id="monteCarloResults" class="mt-3" style="display: none;">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="bi bi-graph-up me-2"></i> Monte Carlo Simulation Results</h5>
                                </div>
                                <div class="card-body">
                                    <div id="monteCarloChart" style="height: 300px;"></div>
                                    <div class="row mt-3">
                                        <div class="col-md-4">
                                            <div class="card bg-light">
                                                <div class="card-body">
                                                    <h6>Best Case (90%)</h6>
                                                    <p class="fs-5 fw-bold positive">₹<span id="bestCaseValue"></span></p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="card bg-light">
                                                <div class="card-body">
                                                    <h6>Expected Case (50%)</h6>
                                                    <p class="fs-5 fw-bold">₹<span id="expectedCaseValue"></span></p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="card bg-light">
                                                <div class="card-body">
                                                    <h6>Worst Case (10%)</h6>
                                                    <p class="fs-5 fw-bold negative">₹<span id="worstCaseValue"></span></p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Sidebar -->
            <div class="col-md-4">
                <!-- AI Advisor -->
                <div class="card">
                    <div class="card-header">
                        <h5><i class="bi bi-robot me-2"></i> AI Investment Advisor</h5>
                    </div>
                    <div class="card-body">
                        <div class="ai-suggestion glow">
                            <h6><i class="bi bi-lightbulb"></i> Today's Top Recommendation</h6>
                            <p>Our AI detects undervalued opportunities in the technology sector. Consider increasing your allocation to <strong>RELIANCE</strong> and <strong>TATAELXSI</strong> by 10-15% to capitalize on the current market correction.</p>
                            <button class="btn btn-sm btn-success mt-2">View Analysis</button>
                        </div>
                        
                        <div class="alert alert-success mt-3">
                            <h6><i class="bi bi-arrow-up-circle"></i> Strong Buy Opportunities</h6>
                            <ul class="mb-0">
                                <li><strong>RELIANCE</strong> (14% upside, AI score 92/100)</li>
                                <li><strong>HDFCBANK</strong> (11.7% upside, stable growth)</li>
                                <li><strong>TATAMOTORS</strong> (EV market leader, 18% upside)</li>
                            </ul>
                        </div>
                        <div class="alert alert-warning mt-2">
                            <h6><i class="bi bi-pause-circle"></i> Hold Positions</h6>
                                                        <ul class="mb-0">
                                <li><strong>INFY</strong> (Wait for better entry point)</li>
                                <li><strong>TCS</strong> (Consolidation phase, hold)</li>
                            </ul>
                        </div>
                        <div class="alert alert-danger mt-2">
                            <h6><i class="bi bi-arrow-down-circle"></i> Consider Selling</h6>
                            <ul class="mb-0">
                                <li><strong>YESBANK</strong> (High risk, poor fundamentals)</li>
                                <li><strong>PNB</strong> (Underperforming sector)</li>
                            </ul>
                        </div>
                        
                        <button class="btn btn-primary w-100 mt-3" id="askAIButton">
                            <i class="bi bi-robot"></i> Ask AI Advisor
                        </button>
                        
                        <div class="mt-3">
                            <label class="form-label">Ask AI a question:</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="aiQuestion" placeholder="e.g., What should I invest in today?">
                                <button class="btn btn-outline-primary" type="button">
                                    <i class="bi bi-send"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Market News -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h5><i class="bi bi-newspaper me-2"></i> Market News & Alerts</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="list-group list-group-flush">
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">RBI keeps repo rate unchanged at 6.5%</h6>
                                    <small class="text-muted">1 hour ago</small>
                                </div>
                                <p class="mb-1">Central bank maintains status quo, signals prolonged pause</p>
                                <small class="text-muted">Economic Times</small>
                                <span class="badge bg-primary ms-2">Macro</span>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">Reliance announces new green energy venture</h6>
                                    <small class="text-muted">2 hours ago</small>
                                </div>
                                <p class="mb-1">Plans $10B investment in renewable energy over 3 years</p>
                                <small class="text-muted">Business Standard</small>
                                <span class="badge bg-success ms-2">Energy</span>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">US Fed signals possible rate hike in July</h6>
                                    <small class="text-muted">4 hours ago</small>
                                </div>
                                <p class="mb-1">Global markets react to hawkish Fed comments</p>
                                <small class="text-muted">Reuters</small>
                                <span class="badge bg-warning ms-2">Global</span>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">TCS wins $2B deal from European bank</h6>
                                    <small class="text-muted">5 hours ago</small>
                                </div>
                                <p class="mb-1">5-year digital transformation contract</p>
                                <small class="text-muted">Moneycontrol</small>
                                <span class="badge bg-info ms-2">IT</span>
                            </a>
                            <a href="#" class="list-group-item list-group-item-action">
                                <div class="d-flex w-100 justify-content-between">
                                    <h6 class="mb-1">Monsoon rains 8% below average</h6>
                                    <small class="text-muted">6 hours ago</small>
                                </div>
                                <p class="mb-1">Agricultural stocks under pressure</p>
                                <small class="text-muted">Financial Express</small>
                                <span class="badge bg-danger ms-2">Agriculture</span>
                            </a>
                        </div>
                        <div class="card-footer text-center">
                            <a href="#" class="text-decoration-none">View all news <i class="bi bi-arrow-right"></i></a>
                        </div>
                    </div>
                </div>

                <!-- Technical Indicators -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h5><i class="bi bi-speedometer2 me-2"></i> Technical Indicators</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <h6>NIFTY 50 Technicals</h6>
                            <div class="d-flex justify-content-between mb-1">
                                <span>RSI (14):</span>
                                <span class="fw-bold">58.7 <span class="neutral">(Neutral)</span></span>
                            </div>
                            <div class="d-flex justify-content-between mb-1">
                                <span>MACD:</span>
                                <span class="fw-bold positive">12.4 <i class="bi bi-arrow-up"></i> (Bullish)</span>
                            </div>
                            <div class="d-flex justify-content-between mb-1">
                                <span>200-Day MA:</span>
                                <span class="fw-bold positive">17,842.5 <i class="bi bi-arrow-up"></i></span>
                            </div>
                            <div class="d-flex justify-content-between">
                                <span>Support/Resistance:</span>
                                <span class="fw-bold">18,450 / 18,950</span>
                            </div>
                        </div>
                        <hr>
                        <div class="mb-3">
                            <h6>Market Sentiment</h6>
                            <div class="progress mb-2" style="height: 20px;">
                                <div class="progress-bar bg-success" role="progressbar" style="width: 65%;">Bullish 65%</div>
                                <div class="progress-bar bg-danger" role="progressbar" style="width: 35%;">Bearish 35%</div>
                            </div>
                            <div class="d-flex justify-content-between small text-muted">
                                <span>Prev: 62% Bullish</span>
                                <span>+3% <i class="bi bi-arrow-up positive"></i></span>
                            </div>
                        </div>
                        <hr>
                        <div>
                            <h6>AI Detected Patterns</h6>
                            <div class="d-flex align-items-center mb-2">
                                <div class="pattern-indicator bg-success"></div>
                                <span>Bullish Flag (NIFTY BANK)</span>
                            </div>
                            <div class="d-flex align-items-center mb-2">
                                <div class="pattern-indicator bg-warning"></div>
                                <span>Head & Shoulders (RELIANCE)</span>
                            </div>
                            <div class="d-flex align-items-center">
                                <div class="pattern-indicator bg-primary"></div>
                                <span>Cup & Handle (TATAMOTORS)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Upcoming Earnings -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h5><i class="bi bi-calendar-event me-2"></i> Upcoming Earnings</h5>
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0">
                                <thead>
                                    <tr>
                                        <th>Company</th>
                                        <th>Date</th>
                                        <th>Est. EPS</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>INFY</td>
                                        <td>Jul 12</td>
                                        <td class="positive">₹16.45 <i class="bi bi-arrow-up"></i></td>
                                    </tr>
                                    <tr>
                                        <td>HDFCBANK</td>
                                        <td>Jul 15</td>
                                        <td class="positive">₹19.20 <i class="bi bi-arrow-up"></i></td>
                                    </tr>
                                    <tr>
                                        <td>RELIANCE</td>
                                        <td>Jul 20</td>
                                        <td class="negative">₹24.10 <i class="bi bi-arrow-down"></i></td>
                                    </tr>
                                    <tr>
                                        <td>TCS</td>
                                        <td>Jul 22</td>
                                        <td class="positive">₹28.75 <i class="bi bi-arrow-up"></i></td>
                                    </tr>
                                    <tr>
                                        <td>ITC</td>
                                        <td>Jul 25</td>
                                        <td class="positive">₹4.85 <i class="bi bi-arrow-up"></i></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="row">
                <div class="col-md-3">
                    <h5>StockTrack Pro</h5>
                    <p>AI-powered investment platform providing real-time analytics, predictive insights, and personalized portfolio management.</p>
                    <div class="mt-3">
                        <a href="#" class="text-white me-2"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="text-white me-2"><i class="bi bi-twitter"></i></a>
                        <a href="#" class="text-white me-2"><i class="bi bi-linkedin"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-youtube"></i></a>
                    </div>
                </div>
                <div class="col-md-3">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white">Dashboard</a></li>
                        <li><a href="#" class="text-white">Portfolio</a></li>
                        <li><a href="#" class="text-white">Stock Screener</a></li>
                        <li><a href="#" class="text-white">Market News</a></li>
                        <li><a href="#" class="text-white">Research Reports</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Resources</h5>
                    <ul class="list-unstyled">
                        <li><a href="#" class="text-white">Learning Center</a></li>
                        <li><a href="#" class="text-white">Investment Strategies</a></li>
                        <li><a href="#" class="text-white">API Documentation</a></li>
                        <li><a href="#" class="text-white">Market Data</a></li>
                        <li><a href="#" class="text-white">Help Center</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Contact Us</h5>
                    <ul class="list-unstyled">
                        <li><i class="bi bi-envelope me-2"></i> shubhdix9@gmail.com</li>
                        <li><i class="bi bi-telephone me-2"></i> +91 9166750197</li>
                        <li><i class="bi bi-geo-alt me-2"></i> Jaipur, India</li>
                    </ul>
                    <div class="mt-3">
                        <button class="btn btn-outline-light btn-sm me-2">Feedback</button>
                        <button class="btn btn-outline-light btn-sm">Report Issue</button>
                    </div>
                </div>
            </div>
            <hr class="mt-4 mb-4" style="border-color: #334155;">
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-0">&copy;</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <a href="#" class="text-white me-3">Terms of Service</a>
                    <a href="#" class="text-white me-3">Privacy Policy</a>
                    <a href="#" class="text-white">Disclaimer</a>
                </div>
            </div>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://s3.tradingview.com/tv.js"></script>
    
    <script>
        // Initialize tooltips
        $(document).ready(function(){
            $('[data-bs-toggle="tooltip"]').tooltip();
            
            // Update date and time
            updateDateTime();
            setInterval(updateDateTime, 60000);
            
            // Load portfolio data
            loadPortfolioData();
            
            // Initialize charts
            initPerformanceChart();
            initAllocationChart();
            
            // Initialize TradingView widget
            initTradingViewWidget();
            
            // Theme toggle functionality
            $('#themeToggle').click(function(){
                $('body').toggleClass('dark-mode');
                if($('body').hasClass('dark-mode')) {
                    $(this).html('<i class="bi bi-sun"></i>');
                    localStorage.setItem('theme', 'dark');
                } else {
                    $(this).html('<i class="bi bi-moon"></i>');
                    localStorage.setItem('theme', 'light');
                }
            });
            
            // Check for saved theme preference
            if(localStorage.getItem('theme') === 'dark') {
                $('body').addClass('dark-mode');
                $('#themeToggle').html('<i class="bi bi-sun"></i>');
            }
            
            // Stock search functionality
            $('#stockSearch').on('input', function(){
                const query = $(this).val().trim();
                if(query.length > 1) {
                    simulateSearchResults(query);
                } else {
                    $('#searchResults').hide();
                }
            });
            
            // Close search results when clicking outside
            $(document).click(function(e) {
                if (!$(e.target).closest('.search-container').length) {
                    $('#searchResults').hide();
                }
            });
        });
        
        function updateDateTime() {
            const now = new Date();
            const options = { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit',
                hour12: true
            };
            $('#currentDateTime').text(now.toLocaleDateString('en-IN', options) + ' IST');
            
            // Update market status based on time
            const hours = now.getHours();
            const minutes = now.getMinutes();
            const marketStatus = $('#marketStatus');
            
            if((hours >= 9 && hours < 15) || (hours === 15 && minutes <= 30)) {
                marketStatus.removeClass('market-closed market-pre market-post').addClass('market-open').text('OPEN');
            } else if(hours >= 15 && hours < 23) {
                marketStatus.removeClass('market-open market-closed market-pre').addClass('market-post').text('POST');
            } else if(hours >= 23 || hours < 9) {
                marketStatus.removeClass('market-open market-post market-pre').addClass('market-closed').text('CLOSED');
            } else {
                marketStatus.removeClass('market-open market-closed market-post').addClass('market-pre').text('PRE');
            }
        }
        
        function loadPortfolioData() {
            // Simulated portfolio data
            const portfolioData = [
                {
                    symbol: 'RELIANCE',
                    name: 'Reliance Industries',
                    quantity: 15,
                    avgCost: 2350.50,
                    currentPrice: 2450.75,
                    allocation: 35
                },
                {
                    symbol: 'TCS',
                    name: 'Tata Consultancy Services',
                    quantity: 20,
                    avgCost: 3200.75,
                    currentPrice: 3150.20,
                    allocation: 25
                },
                {
                    symbol: 'HDFCBANK',
                    name: 'HDFC Bank',
                    quantity: 30,
                    avgCost: 1550.25,
                    currentPrice: 1620.50,
                    allocation: 20
                },
                {
                    symbol: 'INFY',
                    name: 'Infosys',
                    quantity: 40,
                    avgCost: 1300.80,
                    currentPrice: 1280.90,
                    allocation: 15
                },
                {
                    symbol: 'TATAMOTORS',
                    name: 'Tata Motors',
                    quantity: 100,
                    avgCost: 580.40,
                    currentPrice: 620.30,
                    allocation: 5
                }
            ];
            
            let portfolioHTML = '';
            let totalInvested = 0;
            let totalCurrent = 0;
            
            portfolioData.forEach(stock => {
                const invested = stock.quantity * stock.avgCost;
                const current = stock.quantity * stock.currentPrice;
                const pnl = current - invested;
                const pnlPercent = (pnl / invested) * 100;
                
                totalInvested += invested;
                totalCurrent += current;
                
                portfolioHTML += `
                    <tr>
                        <td>
                            <strong>${stock.symbol}</strong><br>
                            <small class="text-muted">${stock.name}</small>
                        </td>
                        <td>${stock.quantity}</td>
                        <td>₹${stock.avgCost.toFixed(2)}</td>
                        <td>₹${invested.toFixed(2)}</td>
                        <td>₹${current.toFixed(2)}</td>
                        <td class="${pnl >= 0 ? 'positive' : 'negative'}">
                            ₹${pnl.toFixed(2)}<br>
                            <small>${pnlPercent.toFixed(2)}%</small>
                        </td>
                        <td>
                            <div class="progress progress-thin">
                                <div class="progress-bar" role="progressbar" style="width: ${stock.allocation}%" aria-valuenow="${stock.allocation}" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            <small>${stock.allocation}%</small>
                        </td>
                        <td>
                            <button class="btn btn-sm btn-outline-primary me-1" title="Buy"><i class="bi bi-plus-circle"></i></button>
                            <button class="btn btn-sm btn-outline-danger" title="Sell"><i class="bi bi-dash-circle"></i></button>
                        </td>
                    </tr>
                `;
            });
            
            const totalPnl = totalCurrent - totalInvested;
            const totalPnlPercent = (totalPnl / totalInvested) * 100;
            
            portfolioHTML += `
                <tr class="table-active">
                    <td><strong>Total</strong></td>
                    <td></td>
                    <td></td>
                    <td><strong>₹${totalInvested.toFixed(2)}</strong></td>
                    <td><strong>₹${totalCurrent.toFixed(2)}</strong></td>
                    <td class="${totalPnl >= 0 ? 'positive' : 'negative'}">
                        <strong>₹${totalPnl.toFixed(2)}</strong><br>
                        <small>${totalPnlPercent.toFixed(2)}%</small>
                    </td>
                    <td></td>
                    <td></td>
                </tr>
            `;
            
            $('#portfolioTable').html(portfolioHTML);
        }
        
        function initPerformanceChart() {
            const options = {
                series: [{
                    name: 'Portfolio Value',
                    data: [
                        { x: '2023-01-01', y: 100000 },
                        { x: '2023-02-01', y: 105000 },
                        { x: '2023-03-01', y: 98000 },
                        { x: '2023-04-01', y: 110000 },
                        { x: '2023-05-01', y: 115000 },
                        { x: '2023-06-01', y: 124567 }
                    ]
                }, {
                    name: 'NIFTY 50',
                    data: [
                        { x: '2023-01-01', y: 18000 },
                        { x: '2023-02-01', y: 17500 },
                        { x: '2023-03-01', y: 17000 },
                        { x: '2023-04-01', y: 17800 },
                        { x: '2023-05-01', y: 18200 },
                        { x: '2023-06-01', y: 18742 }
                    ]
                }],
                chart: {
                    height: 350,
                    type: 'area',
                    toolbar: {
                        show: true,
                        tools: {
                            download: true,
                            selection: true,
                            zoom: true,
                            zoomin: true,
                            zoomout: true,
                            pan: true,
                            reset: true
                        }
                    },
                    animations: {
                        enabled: true,
                        easing: 'easeinout',
                        speed: 800
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    curve: 'smooth',
                    width: 2
                },
                xaxis: {
                    type: 'datetime',
                    labels: {
                        datetimeUTC: false
                    }
                },
                yaxis: {
                    labels: {
                        formatter: function(value) {
                            return '₹' + value.toLocaleString('en-IN');
                        }
                    }
                },
                tooltip: {
                    x: {
                        format: 'dd MMM yyyy'
                    },
                    y: {
                        formatter: function(value) {
                            return '₹' + value.toLocaleString('en-IN');
                        }
                    }
                },
                colors: ['#3b82f6', '#10b981'],
                fill: {
                    type: 'gradient',
                    gradient: {
                        shadeIntensity: 1,
                        opacityFrom: 0.7,
                        opacityTo: 0.3,
                        stops: [0, 100]
                    }
                },
                legend: {
                    position: 'top'
                }
            };
            
            const chart = new ApexCharts(document.querySelector("#stockPerformanceChart"), options);
            chart.render();
        }
        
        function initAllocationChart() {
            const options = {
                series: [35, 25, 20, 15, 5],
                labels: ['RELIANCE', 'TCS', 'HDFCBANK', 'INFY', 'TATAMOTORS'],
                chart: {
                    type: 'donut',
                    height: 350
                },
                colors: ['#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6'],
                plotOptions: {
                    pie: {
                        donut: {
                            size: '65%',
                            labels: {
                                show: true,
                                total: {
                                    show: true,
                                    label: 'Total Portfolio',
                                    formatter: function(w) {
                                        return '₹1,24,567'
                                    }
                                }
                            }
                        }
                    }
                },
                dataLabels: {
                    enabled: true,
                    formatter: function(val, opts) {
                        return opts.w.config.series[opts.seriesIndex] + '%'
                    }
                },
                legend: {
                    position: 'bottom'
                },
                responsive: [{
                    breakpoint: 480,
                    options: {
                        chart: {
                            width: 200
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }]
            };
            
            const chart = new ApexCharts(document.querySelector("#portfolioAllocationChart"), options);
            chart.render();
        }
        
        function initTradingViewWidget() {
            new TradingView.widget({
                "autosize": true,
                "symbol": "NSE:NIFTY",
                "interval": "D",
                "timezone": "Asia/Kolkata",
                "theme": localStorage.getItem('theme') === 'dark' ? 'dark' : 'light',
                "style": "1",
                "locale": "in",
                "toolbar_bg": "#f1f5f9",
                "enable_publishing": false,
                "hide_top_toolbar": false,
                "hide_side_toolbar": false,
                "allow_symbol_change": true,
                "container_id": "tradingview-widget-container__widget"
            });
        }
        
        function simulateSearchResults(query) {
            // Simulated search results
            const stocks = [
                { symbol: 'RELIANCE', name: 'Reliance Industries Ltd', exchange: 'NSE' },
                { symbol: 'TCS', name: 'Tata Consultancy Services Ltd', exchange: 'NSE' },
                { symbol: 'HDFCBANK', name: 'HDFC Bank Ltd', exchange: 'NSE' },
                { symbol: 'INFY', name: 'Infosys Ltd', exchange: 'NSE' },
                { symbol: 'TATAMOTORS', name: 'Tata Motors Ltd', exchange: 'NSE' },
                { symbol: 'ITC', name: 'ITC Ltd', exchange: 'NSE' },
                { symbol: 'SBIN', name: 'State Bank of India', exchange: 'NSE' },
                { symbol: 'BHARTIARTL', name: 'Bharti Airtel Ltd', exchange: 'NSE' }
            ];
            
            const results = stocks.filter(stock => 
                stock.symbol.toLowerCase().includes(query.toLowerCase()) || 
                stock.name.toLowerCase().includes(query.toLowerCase())
            );
            
            const resultsHTML = results.map(stock => `
                <div class="search-item">
                    <div class="d-flex justify-content-between">
                        <div>
                            <strong>${stock.symbol}</strong><br>
                            <small class="text-muted">${stock.name}</small>
                        </div>
                        <span class="badge bg-secondary">${stock.exchange}</span>
                    </div>
                </div>
            `).join('');
            
            $('#searchResults').html(resultsHTML).show();
        }
        
        function calculateInvestment() {
            const initialInvestment = parseFloat($('#initialInvestment').val()) || 0;
            const monthlyContribution = parseFloat($('#monthlyContribution').val()) || 0;
            const interestRate = parseFloat($('#interestRate').val()) || 0;
            const investmentPeriod = parseFloat($('#investmentPeriod').val()) || 0;
            const inflationRate = parseFloat($('#inflationRate').val()) || 0;
            const taxRate = parseFloat($('#taxRate').val()) || 0;
            
            // Calculate future value
            const monthlyRate = interestRate / 100 / 12;
            const months = investmentPeriod * 12;
            
            // Future value of initial investment
            const futureValueInitial = initialInvestment * Math.pow(1 + monthlyRate, months);
            
            // Future value of monthly contributions
            const futureValueContributions = monthlyContribution * 
                (Math.pow(1 + monthlyRate, months) - 1) / monthlyRate;
            
            const futureValue = futureValueInitial + futureValueContributions;
            const totalContributions = initialInvestment + (monthlyContribution * months);
            const interestEarned = futureValue - totalContributions;
            
            // Inflation adjusted calculations
            const realRate = ((1 + (interestRate/100)) / (1 + (inflationRate/100))) - 1;
            const realFutureValue = futureValue / Math.pow(1 + (inflationRate/100), investmentPeriod);
            
            // After tax value
            const taxableAmount = interestEarned;
            const taxAmount = taxableAmount * (taxRate/100);
            const afterTaxValue = futureValue - taxAmount;
            
            // Purchasing power
            const purchasingPower = afterTaxValue / Math.pow(1 + (inflationRate/100), investmentPeriod);
            
            // Display results
            $('#futureValue').text('₹' + futureValue.toFixed(2).toLocaleString('en-IN'));
            $('#totalContributions').text('₹' + totalContributions.toFixed(2).toLocaleString('en-IN'));
            $('#interestEarned').text('₹' + interestEarned.toFixed(2).toLocaleString('en-IN'));
            $('#realFutureValue').text('₹' + realFutureValue.toFixed(2).toLocaleString('en-IN'));
            $('#afterTaxValue').text('₹' + afterTaxValue.toFixed(2).toLocaleString('en-IN'));
            $('#purchasingPower').text('₹' + purchasingPower.toFixed(2).toLocaleString('en-IN'));
            
            $('#calculationResult').show();
            $('#monteCarloResults').hide();
        }
        
        function runMonteCarloSimulation() {
            // This is a simplified simulation for demo purposes
            const initialInvestment = parseFloat($('#initialInvestment').val()) || 0;
            const monthlyContribution = parseFloat($('#monthlyContribution').val()) || 0;
            const interestRate = parseFloat($('#interestRate').val()) || 0;
            const investmentPeriod = parseFloat($('#investmentPeriod').val()) || 0;
            
            // Generate simulation data
            const simulations = [];
            const months = investmentPeriod * 12;
            
            for(let i = 0; i < 100; i++) {
                const simulation = [];
                let currentValue = initialInvestment;
                
                for(let m = 1; m <= months; m++) {
                    // Add random volatility to the return rate
                    const volatility = (Math.random() - 0.5) * 0.2; // +/- 10% random variation
                    const monthlyRate = (interestRate / 100 / 12) + volatility;
                    
                    currentValue = currentValue * (1 + monthlyRate) + monthlyContribution;
                    simulation.push(currentValue);
                }
                
                simulations.push(simulation);
            }
            
            // Calculate percentiles
            simulations.sort((a, b) => a[months-1] - b[months-1]);
            const bestCase = simulations[90][months-1]; // 90th percentile
            const expectedCase = simulations[50][months-1]; // 50th percentile
            const worstCase = simulations[10][months-1]; // 10th percentile
            
            // Display results
            $('#bestCaseValue').text(bestCase.toFixed(2).toLocaleString('en-IN'));
            $('#expectedCaseValue').text(expectedCase.toFixed(2).toLocaleString('en-IN'));
            $('#worstCaseValue').text(worstCase.toFixed(2).toLocaleString('en-IN'));
            
            // Prepare chart data
            const chartData = {
                series: [],
                categories: []
            };
            
            // Add sample simulations to the chart (for performance, we'll only show 10)
            for(let i = 0; i < 10; i++) {
                chartData.series.push({
                    name: `Simulation ${i+1}`,
                    data: simulations[i]
                });
            }
            
            // Generate month categories
            for(let m = 1; m <= months; m++) {
                chartData.categories.push(`Month ${m}`);
            }
            
            // Initialize Monte Carlo chart
            const options = {
                series: chartData.series,
                chart: {
                    height: 300,
                    type: 'line',
                    zoom: {
                        enabled: false
                    },
                    animations: {
                        enabled: true
                    }
                },
                dataLabels: {
                    enabled: false
                },
                stroke: {
                    curve: 'smooth',
                    width: 1,
                    opacity: 0.7
                },
                colors: ['#3b82f6', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#ec4899', '#14b8a6', '#f97316', '#64748b', '#a855f7'],
                xaxis: {
                    categories: chartData.categories,
                    labels: {
                        show: false
                    }
                },
                yaxis: {
                    labels: {
                        formatter: function(value) {
                            return '₹' + value.toLocaleString('en-IN');
                        }
                    }
                },
                tooltip: {
                    y: {
                        formatter: function(value) {
                            return '₹' + value.toLocaleString('en-IN');
                        }
                    }
                },
                legend: {
                    show: false
                }
            };
            
            // Destroy previous chart if exists
            if(window.monteCarloChart) {
                window.monteCarloChart.destroy();
            }
            
            window.monteCarloChart = new ApexCharts(document.querySelector("#monteCarloChart"), options);
            window.monteCarloChart.render();
            
            $('#calculationResult').hide();
            $('#monteCarloResults').show();
        }
        
        // AI Advisor interaction
        $('#askAIButton').click(function() {
            const questions = [
                "What are the best stocks to buy today?",
                "How should I adjust my portfolio in the current market?",
                "What sectors are showing strong growth potential?",
                "Which stocks in my portfolio should I consider selling?",
                "What's your outlook on the technology sector?"
            ];
            
            const randomQuestion = questions[Math.floor(Math.random() * questions.length)];
            
            Swal.fire({
                title: 'AI Advisor',
                html: `<p><strong>Your question:</strong> ${randomQuestion}</p>
                       <div class="alert alert-success mt-3">
                           <p><strong>AI Response:</strong> Based on current market conditions and your portfolio, I recommend focusing on large-cap technology stocks with strong fundamentals. Specifically, consider increasing your position in RELIANCE and TATAELXSI as they show strong technical indicators and positive earnings momentum.</p>
                           <p class="mb-0">Always remember to diversify and consider your risk tolerance before making investment decisions.</p>
                       </div>`,
                confirmButtonText: 'Ask Another Question',
                showCancelButton: true,
                cancelButtonText: 'Close',
                width: '800px'
            });
        });
    </script>
    
    <!-- SweetAlert for AI Advisor -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</body>
</html>
